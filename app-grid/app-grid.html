<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../../polymer/polymer.html">
<link rel="import" href="../../iron-flex-layout/iron-flex-layout.html">

<dom-module id="app-grid">
  <style>

    :host {
      display: block;
    }

    div {
      @apply(--layout-horizontal);
      @apply(--layout-wrap);
      margin-right: calc(var(--gutter, 0px)  * -1);
    }

    :host([centered-items]) div {
      @apply(--layout-center-center);
    }

    div ::content > [grid-item] {
      display: block;
      position: relative;
      content: var(--columns);
      flex: 1 1 calc(100% / var(--columns, 1) - var(--gutter, 0px) );
      max-width: calc(100% / var(--columns, 1) - var(--gutter, 0px));
     
      margin-right: var(--gutter, 0px);
      margin-bottom: var(--gutter, 0px);
    }

    div ::content > [grid-item]::before {
      content: "";
      display: block;
      padding-top: var(--cell-height, 100%);
    }


    div ::content > [grid-item][columns="2"] {
      flex: 1 1 calc(100% / var(--columns, 1) * 2 - var(--gutter, 0px));
      max-width: calc(100% / var(--columns, 1) * 2 - var(--gutter, 0px));
    }

    div ::content > [grid-item][columns="2"]::before {
      content: "";
      display: block;
      padding-top: calc((var(--cell-height, 100%) - var(--gutter, 0px)) / 2);
    }

    div ::content > [grid-item][columns="3"] {
      flex: 1 1 calc(100% / var(--columns, 1) * 3 - var(--gutter, 0px));
      max-width: calc(100% / var(--columns, 1) * 3 - var(--gutter, 0px));
    }

    div ::content > [grid-item][columns="3"]::before {
      content: "";
      display: block;
      padding-top: calc((var(--cell-height, 100%) - var(--gutter, 0px) * 2) / 3);
    }


    div ::content > [grid-item] > * {
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
    }

  </style>

  <template>
    <div>
      <content></content>
    </div>
  </template>

  <script>
    Polymer({

      is: 'app-grid',

      attached: function() {
        window.addEventListener('resize', this.updateGrid.bind(this));
      },

      updateGrid: function() {
        console.time('updateGrid');
        this.updateStyles();
        console.timeEnd('updateGrid');
      }

    });
  </script>

</dom-module>
